@model budgetApp.Models.ReportModel
<head>
    <link rel="stylesheet" href="~/css/site.css" />
</head>
<body onload="setEditVisibility(false)">
<h2>@ViewBag.Msg</h2>
<form asp-controller="Home" method="post" id="reportForm" role="form">
    @Html.DropDownListFor(x => x.category, Model.categories)
    @Html.DropDownListFor(x => x.period, Model.periods)
    <button type="submit" class="btn btn-outline-primary">View</button>
</form>
@Html.Raw(Model.strHTML)
@Html.Raw(Model.strHTMLTable)
<input type="checkbox" id="chkEditable" value="false" hidden />
</body>
<script>
function checkEditState() {
    if(document.getElementById("chkEditable").checked){
        document.getElementById("editStateHead").innerHTML = "<img src=\"/lib/images/lock.jpg\" class=\"img-header\" onclick=\"checkEditState()\"/>"
        //flip checkbox
        document.getElementById("chkEditable").checked = false;
        setEditVisibility(false)

    }else{
        document.getElementById("editStateHead").innerHTML = "<img src=\"/lib/images/unlock.jpg\" class=\"img-header\" onclick=\"checkEditState()\"/>"
        document.getElementById("chkEditable").checked = true;
        setEditVisibility(true)
    }
}
function setEditVisibility(blnVisible){
    var table = document.getElementById("reportTable");
    for(let i = 0; i < table.rows.length - 1; i++){
        if(blnVisible){
            document.getElementById("edt" + i).setAttribute("class", "btn btn-warning btn-sm btn-row");
            document.getElementById("del" + i).setAttribute("class", "btn btn-danger btn-sm btn-row");
        }else{
            document.getElementById("edt" + i).setAttribute("class", "btn btn-secondary btn-sm btn-row");
            document.getElementById("del" + i).setAttribute("class", "btn btn-secondary btn-sm btn-row");
        }
    }
}
function editEntry(e, t){
    if(document.getElementById("chkEditable").checked){
        if(confirm("Change Entry?")){
            var url = "editEntry";
            $.post(url)
        }
    }
    
}
function deleteEntry(e, id){
    if(document.getElementById("chkEditable").checked){
        if(confirm("Delete Entry?")){
            //id will bet delx where x is the number, we have to parse it.
            alert(id)
            var x = id.replace('d','');
            x = x.replace('e','');
            x = x.replace('l', '');
            alert(x);
            // we need to post the id of the entry to delete to the controller
            var url = "deleteEntry?entryID=" + x;
            $.post(url)
        }else{
            return;
        }
    }
}
</script>